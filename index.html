<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/model.js"></script>
    <script src="js/script.js"></script>

<script>
	function initializeVariables(){
		this.currentSelectedQuestion = -1;
		var m = new model();
		loadModelDummyData(m);
	}
	
	function setQuestion(newID){
		//alert('setting new question');
		this.currentSelectedQuestion = newID;
		//alert('currentlySelectedQuestion is '+currentSelectedQuestion);
		reloadData();
	}
	
	function foo(){
		alert('Foo');
	}
	
	function reloadData(){
		var questions = m.getQuestions("");
		var questionList = document.getElementById('questions');
		while (questionList.firstChild) {
			questionList.removeChild(questionList.firstChild);
		}
		for(var i = 0; i < questions.length; i++){
			var currentQuestion = questions[i];
			var currentQuestionID = currentQuestion.ID;
			var questionDiv = document.createElement('div');
			questionDiv.className = "question";
			var questionHTML = "";
			questionHTML += "<div class=\"vote\">\n";
			questionHTML += "<button type=\"button\" onclick=\"setQuestion("+currentQuestion.ID+")\" class=\"upvote\"></button>\n";
			questionHTML += "</div>\n";
			questionHTML += "<div class=\"score\">"+currentQuestion.upvotes+"</div>\n";
			questionHTML += "<div class=\"text\" onclick=\"setQuestion("+currentQuestionID+")\">"+currentQuestion.title+"\"</div>\n";
			questionHTML += "<div class=\"answers\">"+m.getQuestionAnswers(currentQuestion.ID).length+"<div>answers</div></div>\n";
			questionDiv.innerHTML =  questionHTML;
			questionList.appendChild(questionDiv);
			if(currentQuestion.ID == currentSelectedQuestion){
				//alert(currentQuestion.ID + ' = '+currentSelectedQuestion);
				var answerListDiv = document.createElement('div');
				answerListDiv.className = "answer-list";
				var answers = m.getQuestionAnswers(currentQuestionID);
				answerListDiv.innerHTML = '';
				for(var j = 0; j < answers.length; j++){
					var currentAnswer = answers[j];
					var answerHTML = "<div class=\"answer\">\n";
					answerHTML += "<div class=\"vote\">\n";
					answerHTML += "<button class=\"upvote\"></button>\n";
					answerHTML += "<button class=\"downvote\"></button>\n";
					answerHTML += "</div>\n";
					answerHTML += "<div class=\"score\">"+currentAnswer.upvotes+"</div>\n";
					answerHTML += "<div class=\"text\">"+currentAnswer.content+"</div>\n";
					answerHTML += "</div>\n";
					answerListDiv.innerHTML += answerHTML;
				}
				questionList.appendChild(answerListDiv);
			} else {
				//alert('Not loading answers');
			}
		}
		//alert('reloading terminated');
	}

    window.addEventListener("DOMContentLoaded", function() {
		//alert('DOM loaded');
		initializeVariables();
		reloadData();
    }, false);
</script>
</head>
<body>
    <header>
        <div class="title"><h2>Bio 130</h2></div>
        <div class="search"><input type="text" name="search"></div>
        <div class="settings">
            <img src="img/gear.png">
        </div>
    </header>
    <article>   
        <div id="questions" class="question-list">
	    <!--
            <div id="q1" class="question">
                <div class="vote">
>>>>>>> cc78e1a1236b4f21d9b0045dedc92d7bf5cf2fcf
                    <button class="upvote"></button>
                </div>
                <div class="score">20</div>
                <div class="text">What is a cell?</div>
                <div class="answers">4<div>answers</div></div>
            </div>
            <div id="al1" class="answer-list">
                <div id="a1" class="answer">
                        <div class="vote">
                        <button class="upvote"></button>
                        <button class="downvote"></button>
                    </div>
                    <div class="score">20</div>
                    <div class="text">A cell is a thing that...</div>
                </div>
            </div>
            <div id="q2" class="question">
                <div class="vote">
                    <button class="upvote"></button>
                </div>
                <div class="score">20</div>
                <div class="text">What is a cell?</div>
                <div class="answers">4<div>answers</div></div>
            </div>
	    -->
        </div>

        <div class="tag-list">
            <div>
                <h4>Popular Tags</h4>
                <ul>
                    <li><a href="http://google.com">Cells</a></li>
                    <li><a href="http://google.com">Plants</a></li>
                    <li><a href="http://google.com">Animals</a></li>
                </ul>
            </div>
        </div>
    </article>

</body>
</html>
